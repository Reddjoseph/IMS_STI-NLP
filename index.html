<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Custom Website</title>
  <link rel="stylesheet" href="style.css" />
  <style>
  /* Navbar transparent and fixed */
  nav.navbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(17, 17, 17, 0.85);
    padding: 10px 20px;
    z-index: 10000;
    display: flex;
    align-items: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    font-family: Arial, sans-serif;
  }

  nav.navbar img.logo {
    height: 80px; 
    width: auto;
    margin-right: 20px;
    z-index: 10100;
  }

  nav.navbar ul {
    list-style: none;
    display: flex;
    gap: 20px;
    margin: 0;
    padding: 0;
    align-items: center;
    flex-grow: 1;
  }

  nav.navbar ul li {
    display: flex;
    align-items: center;
    height: 80px;
  }

  nav.navbar ul li a {
    color: white;
    text-decoration: none;
    font-weight: 500;
    padding: 8px 12px;
    display: flex;
    align-items: center;
    height: 100%;
  }

  nav ul li a.active {
    color: yellow;
    font-weight: bold;
  }

  /* Group login button and avatar */
  nav.navbar ul li.login-avatar-group {
    margin-left: auto; 
    display: flex;
    align-items: center;
    gap: 10px;
    height: 80px;
    position: relative; 
  }

  /* Login button styles */
  nav.navbar ul li.login-avatar-group a.login-btn {
    height: 40px;
    padding: 0 18px;
    border: 2px solid white;
    border-radius: 25px;
    font-weight: 700;
    font-size: 18px;
    color: white;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: color 0.4s, border-color 0.4s;
    box-sizing: border-box;
    line-height: normal;
    margin: 0;
  }

  nav.navbar ul li.login-avatar-group a.login-btn:hover {
    color: yellow;
    border-color: yellow;
  }

  /* Replacing avatar div with button styles */
  #user-avatar-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid rgb(238, 255, 0);
    background: url('https://cdn-icons-png.flaticon.com/512/149/149071.png') no-repeat center center;
    background-size: cover;
    padding: 0;
    margin: 0;
  }

  /* Avatar dropdown */
  #avatar-dropdown {
    position: absolute;
    top: 48px; 
    right: 0;
    background: rgba(0, 0, 0, 0.8);
    border-radius: 5px;
    min-width: 120px;
    display: none;
    z-index: 11000; 
  }

  #avatar-dropdown a#logout-btn {
    display: block;
    padding: 10px;
    color: white;
    text-decoration: none;
    cursor: pointer;
  }

  #avatar-dropdown a#logout-btn:hover {
    background: rgb(238, 255, 0);
    color: black;
  }

  /* Add top padding so page content is not under navbar */
  #main-content, #about-page {
    padding-top: 120px; 
    padding-left: 20px;
    padding-right: 20px;
    max-width: 900px;
    margin: 0 auto;
  }
  </style>
</head>
<body style="
  background: url('Assets/BG_Main.jpg') no-repeat center center fixed;
  background-size: cover;
  color: white;
  margin: 0;
  font-family: Arial, sans-serif;
">

  <div class="wrapper">

    <nav class="navbar">
      <a id="logo-link" href="#"><img src="Assets/Logo_STI.png" alt="Logo" class="logo" /></a>

      <ul>
        <li><a href="#" id="home-link" class="active">Home</a></li>
        <li><a href="#" id="about-link">About</a></li>
        <li id="inventory-link" style="display: none;"><a href="inventory.html">Inventory</a></li>

        <!-- Group login button and avatar together -->
        <li class="login-avatar-group" style="display: flex;">
          <a href="#" class="login-btn">Login</a>

          <!-- User avatar replaced with button -->
          <button id="user-avatar-btn" title="User Profile" style="display:none;"></button>
          <div id="avatar-dropdown">
            <a href="#" id="logout-btn">Logout</a>
          </div>
        </li>
      </ul>
    </nav>

    <!-- Main content -->
    <div id="main-content" style="font-size: 24px;">
        <!--Home Page Content (GOES HERE)-->
    </div>

    <!-- About content (hidden by default) -->
    <div id="about-page" style="display: none; font-size: 24px;">
      <!-- Will be filled dynamically by JS -->
    </div>

    <!-- Login/Register Modal -->
    <div id="login-modal" style="display:none; position: fixed; top: 20%; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.9); padding: 30px; border-radius: 10px; color: white; width: 300px; z-index: 1000;">
      <h2>Login</h2>
      <input type="email" id="email" placeholder="Email" style="width: 100%; padding: 8px; margin-bottom: 10px;" />
      <input type="password" id="password" placeholder="Password" style="width: 100%; padding: 8px; margin-bottom: 10px;" />

      <button id="login-btn" style="width: 100%; padding: 10px; background: rgb(238, 255, 0); border: none; border-radius: 25px; font-weight: 700; cursor: pointer;">Login</button>

      <button id="register-btn" style="display:none; width: 100%; padding: 10px; background: rgb(238, 255, 0); border: none; border-radius: 25px; font-weight: 700; cursor: pointer;">Register</button>

      <div style="margin-top: 10px; display: flex; justify-content: space-between;">
        <button id="close-login" style="width: 48%; padding: 8px; background: transparent; border: 1px solid white; border-radius: 25px; cursor: pointer; color: white;">Close</button>
        <button id="toggle-register" style="width: 48%; padding: 8px; background: transparent; border: 1px solid white; border-radius: 25px; cursor: pointer; color: white;">Register</button>
        <button id="toggle-login" style="display:none; width: 48%; padding: 8px; background: transparent; border: 1px solid white; border-radius: 25px; cursor: pointer; color: white;">Login</button>
      </div>

      <p id="login-error" style="color: red; margin-top: 10px;"></p>
    </div>

  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

  <script>
  // Firebase config and initialization
  const firebaseConfig = {
    apiKey: "AIzaSyAw2rSjJ3f_S98dntbsyl9kyXvi9MC44Dw",
    authDomain: "fir-inventory-2e62a.firebaseapp.com",
    projectId: "fir-inventory-2e62a",
    storageBucket: "fir-inventory-2e62a.firebasestorage.app",
    messagingSenderId: "380849220480",
    appId: "1:380849220480:web:5a43b227bab9f9a197af65",
    measurementId: "G-ERT87GL4XC"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  // DOM elements for auth and UI
  const loginModal = document.getElementById('login-modal');
  const loginBtn = document.querySelector('.login-btn');
  const closeLoginBtn = document.getElementById('close-login');
  const loginSubmitBtn = document.getElementById('login-btn');
  const registerSubmitBtn = document.getElementById('register-btn');
  const toggleToRegisterBtn = document.getElementById('toggle-register');
  const toggleToLoginBtn = document.getElementById('toggle-login');
  const loginError = document.getElementById('login-error');
  const modalTitle = document.querySelector('#login-modal h2');

  const userAvatarBtn = document.getElementById('user-avatar-btn');
  const avatarDropdown = document.getElementById('avatar-dropdown');
  const logoutBtn = document.getElementById('logout-btn');

  const inventoryLink = document.getElementById('inventory-link');

  // DOM elements for content toggle
  const aboutLink = document.getElementById('about-link');
  const homeLink = document.getElementById('home-link');
  const mainContent = document.getElementById('main-content');
  const aboutPage = document.getElementById('about-page');

  // Show login modal
  loginBtn.addEventListener('click', (e) => {
    e.preventDefault();
    showLoginForm();
    loginModal.style.display = 'block';
  });

  // Close login modal
  closeLoginBtn.addEventListener('click', () => {
    loginModal.style.display = 'none';
    loginError.textContent = '';
  });

  // Login submit
  loginSubmitBtn.addEventListener('click', () => {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();

    if(!email || !password) {
      loginError.textContent = "Please enter email and password.";
      return;
    }

    auth.signInWithEmailAndPassword(email, password)
      .then(() => {
        loginError.textContent = '';
        loginModal.style.display = 'none';
        alert('Logged in successfully!');
      })
      .catch((error) => {
        loginError.textContent = error.message;
      });
  });

  // Register submit
  registerSubmitBtn.addEventListener('click', () => {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();

    if(!email || !password) {
      loginError.textContent = "Please enter email and password.";
      return;
    }

    auth.createUserWithEmailAndPassword(email, password)
      .then(() => {
        loginError.textContent = '';
        loginModal.style.display = 'none';
        alert('Registered and logged in successfully!');
      })
      .catch((error) => {
        loginError.textContent = error.message;
      });
  });

  // Toggle to register form
  toggleToRegisterBtn.addEventListener('click', () => {
    showRegisterForm();
  });

  // Toggle back to login form
  toggleToLoginBtn.addEventListener('click', () => {
    showLoginForm();
  });

  function showLoginForm() {
    modalTitle.textContent = 'Login';
    loginSubmitBtn.style.display = 'block';
    registerSubmitBtn.style.display = 'none';
    toggleToRegisterBtn.style.display = 'inline-block';
    toggleToLoginBtn.style.display = 'none';
    loginError.textContent = '';
  }

  function showRegisterForm() {
    modalTitle.textContent = 'Register';
    loginSubmitBtn.style.display = 'none';
    registerSubmitBtn.style.display = 'block';
    toggleToRegisterBtn.style.display = 'none';
    toggleToLoginBtn.style.display = 'inline-block';
    loginError.textContent = '';
  }

  // Update UI based on auth state
  auth.onAuthStateChanged(user => {
    if (user) {
      loginBtn.style.display = 'none';
      userAvatarBtn.style.display = 'block';

      // Show inventory link for authenticated users
      inventoryLink.style.display = 'inline-flex';

      // Load user photoURL or default avatar as button background
      if (user.photoURL) {
        userAvatarBtn.style.backgroundImage = `url(${user.photoURL})`;
      } else {
        userAvatarBtn.style.backgroundImage = `url('https://cdn-icons-png.flaticon.com/512/149/149071.png')`;
      }
    } else {
      loginBtn.style.display = 'flex';
      userAvatarBtn.style.display = 'none';
      inventoryLink.style.display = 'none';
      avatarDropdown.style.display = 'none';
    }
  });

  // Avatar dropdown toggle on button click
  userAvatarBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    avatarDropdown.style.display = avatarDropdown.style.display === 'block' ? 'none' : 'block';
  });

  // Hide dropdown if clicking outside
  document.addEventListener('click', () => {
    avatarDropdown.style.display = 'none';
  });

  // Logout
  logoutBtn.addEventListener('click', (e) => {
    e.preventDefault();
    auth.signOut();
    avatarDropdown.style.display = 'none';
    alert('Logged out successfully!');
  });

  // Navigation for about and home
  aboutLink.addEventListener('click', (e) => {
    e.preventDefault();
    mainContent.style.display = 'none';
    aboutPage.style.display = 'block';
    homeLink.classList.remove('active');
    aboutLink.classList.add('active');

    // Fill about content
    aboutPage.innerHTML = `
      <p>Welcome to STI-Dasmarinas Inventory Management System</p>
      <p>For more information, visit <a href="https://sti.edu/" target="_blank" style="color: yellow;">STI Website</a> for more info.</p>
    `;
  });

  homeLink.addEventListener('click', (e) => {
    e.preventDefault();
    mainContent.style.display = 'block';
    aboutPage.style.display = 'none';
    homeLink.classList.add('active');
    aboutLink.classList.remove('active');
  });
  </script>

</body>
</html>
